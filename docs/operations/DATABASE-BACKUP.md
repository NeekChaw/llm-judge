# Supabaseæ•°æ®åº“å¤‡ä»½ä¸æ¢å¤æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•å¤‡ä»½å’Œæ¢å¤AI Benchmark V2é¡¹ç›®çš„Supabaseæ•°æ®åº“ã€‚å¤‡ä»½ç³»ç»Ÿæä¾›å®Œæ•´çš„æ•°æ®åº“ç»“æ„å’Œæ•°æ®å¯¼å‡ºï¼Œç¡®ä¿æ•°æ®å®‰å…¨ã€‚

## ğŸ“¦ å¤‡ä»½å†…å®¹

### å¤‡ä»½åŒ…å«çš„è¡¨
- `api_providers` - APIæä¾›å•†é…ç½®
- `models` - AIæ¨¡å‹é…ç½®
- `dimensions` - è¯„æµ‹ç»´åº¦å®šä¹‰
- `evaluators` - è¯„åˆ†å™¨é…ç½®
- `templates` - è¯„æµ‹æ¨¡æ¿
- `test_cases` - æµ‹è¯•ç”¨ä¾‹
- `evaluation_tasks` - è¯„æµ‹ä»»åŠ¡
- `evaluation_results` - è¯„æµ‹ç»“æœ
- `system_configs` - ç³»ç»Ÿé…ç½®
- `code_execution_details` - ä»£ç æ‰§è¡Œè¯¦æƒ…

### å¤‡ä»½æ–‡ä»¶ç»“æ„
```
backups/supabase-backup-YYYY-MM-DDTHH-mm-ss/
â”œâ”€â”€ manifest.json              # å¤‡ä»½æ¸…å•å’Œå…ƒæ•°æ®
â”œâ”€â”€ schema.json                # æ•°æ®åº“æ¶æ„ä¿¡æ¯
â”œâ”€â”€ backup-summary.md          # å¤‡ä»½æŠ¥å‘Š
â”œâ”€â”€ api_providers.json         # å„è¡¨æ•°æ®æ–‡ä»¶
â”œâ”€â”€ models.json
â”œâ”€â”€ dimensions.json
â”œâ”€â”€ evaluators.json
â”œâ”€â”€ templates.json
â”œâ”€â”€ test_cases.json
â”œâ”€â”€ evaluation_tasks.json
â”œâ”€â”€ evaluation_results.json
â”œâ”€â”€ system_configs.json
â””â”€â”€ code_execution_details.json
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆ›å»ºå¤‡ä»½
```bash
# ä½¿ç”¨ä¾¿æ·è„šæœ¬
./backup-database.sh

# æˆ–ç›´æ¥æ‰§è¡ŒTypeScriptè„šæœ¬
npx tsx backup-supabase.ts
```

### 2. æ¢å¤å¤‡ä»½
```bash
# ä½¿ç”¨ä¾¿æ·è„šæœ¬
./restore-database.sh ./backups/supabase-backup-2025-09-09T13-36-09

# æˆ–ç›´æ¥æ‰§è¡ŒTypeScriptè„šæœ¬
npx tsx restore-supabase.ts ./backups/supabase-backup-2025-09-09T13-36-09
```

## ğŸ“‹ è¯¦ç»†ä½¿ç”¨è¯´æ˜

### å¤‡ä»½æ“ä½œ

#### å®Œæ•´å¤‡ä»½
```bash
npx tsx backup-supabase.ts
```

#### è‡ªå®šä¹‰å¤‡ä»½é€‰é¡¹
```typescript
// ä¿®æ”¹ backup-supabase.ts ä¸­çš„é€‰é¡¹
const options: BackupOptions = {
  includeData: true,        // æ˜¯å¦åŒ…å«æ•°æ®
  includeSchema: true,      // æ˜¯å¦åŒ…å«æ¶æ„ä¿¡æ¯
  outputDir: './backups',   // å¤‡ä»½ç›®å½•
  tables: ['models', 'templates']  // å¯é€‰: ä»…å¤‡ä»½æŒ‡å®šè¡¨
};
```

### æ¢å¤æ“ä½œ

#### åŸºç¡€æ¢å¤
```bash
npx tsx restore-supabase.ts ./backups/supabase-backup-2025-09-09T13-36-09
```

#### é«˜çº§æ¢å¤é€‰é¡¹
```bash
# æ¢å¤å‰æ¸…ç©ºç°æœ‰æ•°æ®
npx tsx restore-supabase.ts ./backups/backup-dir --clear

# è·³è¿‡å·²å­˜åœ¨çš„è®°å½•ï¼ˆé¿å…é‡å¤é”®é”™è¯¯ï¼‰
npx tsx restore-supabase.ts ./backups/backup-dir --skip-existing

# ä»…æ¢å¤æŒ‡å®šè¡¨
npx tsx restore-supabase.ts ./backups/backup-dir --tables models,templates
```

## ğŸ”§ æŠ€æœ¯å®ç°

### å¤‡ä»½åŸç†
1. **å¹¶è¡ŒæŸ¥è¯¢**: ä½¿ç”¨Promise.allåŒæ—¶æŸ¥è¯¢å¤šä¸ªè¡¨
2. **åˆ†æ‰¹å¯¼å‡º**: æ¯æ¬¡æŸ¥è¯¢1000æ¡è®°å½•ï¼Œé¿å…å†…å­˜æº¢å‡º
3. **é”™è¯¯å¤„ç†**: å•è¡¨å¤±è´¥ä¸å½±å“å…¶ä»–è¡¨çš„å¤‡ä»½
4. **å…ƒæ•°æ®è®°å½•**: ä¿å­˜å¤‡ä»½æ—¶é—´ã€è¡¨ç»“æ„ã€è®°å½•æ•°ç­‰ä¿¡æ¯

### æ¢å¤åŸç†
1. **éªŒè¯å¤‡ä»½**: æ£€æŸ¥å¤‡ä»½ç›®å½•å’Œæ¸…å•æ–‡ä»¶å®Œæ•´æ€§
2. **æ‰¹é‡æ’å…¥**: æ¯æ¬¡æ’å…¥100æ¡è®°å½•ï¼Œæé«˜æ€§èƒ½
3. **å†²çªå¤„ç†**: æ”¯æŒè·³è¿‡å·²å­˜åœ¨è®°å½•æˆ–æ¸…ç©ºåæ¢å¤
4. **è¿›åº¦è·Ÿè¸ª**: æ˜¾ç¤ºæ¢å¤è¿›åº¦å’Œè¯¦ç»†ç»“æœ

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

### å¤‡ä»½å®‰å…¨
- å®šæœŸåˆ›å»ºå¤‡ä»½ï¼ˆå»ºè®®æ¯æ—¥æˆ–æ¯å‘¨ï¼‰
- å°†å¤‡ä»½æ–‡ä»¶å­˜å‚¨åœ¨å®‰å…¨ä½ç½®
- å‹ç¼©åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œå¦¥å–„ä¿ç®¡
- å®šæœŸéªŒè¯å¤‡ä»½å®Œæ•´æ€§

### æ¢å¤å®‰å…¨
- æ¢å¤å‰å…ˆå¤‡ä»½å½“å‰æ•°æ®
- åœ¨æµ‹è¯•ç¯å¢ƒä¸­éªŒè¯æ¢å¤æµç¨‹
- æ¢å¤æ—¶ä»”ç»†ç¡®è®¤ç›®æ ‡æ•°æ®åº“
- æ¢å¤åéªŒè¯æ•°æ®å®Œæ•´æ€§

## ğŸ“Š ç›‘æ§ä¸ç»´æŠ¤

### å¤‡ä»½ç›‘æ§
```bash
# æ£€æŸ¥æœ€è¿‘çš„å¤‡ä»½
ls -la backups/ | head -10

# æŸ¥çœ‹å¤‡ä»½å¤§å°
du -sh backups/*

# éªŒè¯å¤‡ä»½å†…å®¹
cat backups/latest/backup-summary.md
```

### æ€§èƒ½ä¼˜åŒ–
- **å¤§è¡¨åˆ†æ‰¹å¤„ç†**: evaluation_resultsç­‰å¤§è¡¨è‡ªåŠ¨åˆ†æ‰¹
- **å¹¶å‘é™åˆ¶**: é¿å…è¿‡å¤šå¹¶å‘æŸ¥è¯¢å½±å“æ•°æ®åº“æ€§èƒ½
- **å‹ç¼©å­˜å‚¨**: è‡ªåŠ¨åˆ›å»ºå‹ç¼©åŒ…å‡å°‘å­˜å‚¨ç©ºé—´

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç¯å¢ƒå˜é‡é”™è¯¯
```
Error: NEXT_PUBLIC_SUPABASE_URL or SUPABASE_URL environment variable is required
```
**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿`.env.local`æ–‡ä»¶å­˜åœ¨ä¸”åŒ…å«æ­£ç¡®çš„Supabaseé…ç½®

#### 2. æƒé™é”™è¯¯
```
Error: permission denied
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥Supabase APIå¯†é’¥æƒé™ï¼Œç¡®ä¿æœ‰è¯»å†™æƒé™

#### 3. ç½‘ç»œè¿æ¥é—®é¢˜
```
Error: fetch failed
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒSupabaseæœåŠ¡çŠ¶æ€

#### 4. ç£ç›˜ç©ºé—´ä¸è¶³
```
Error: ENOSPC: no space left on device
```
**è§£å†³æ–¹æ¡ˆ**: æ¸…ç†ç£ç›˜ç©ºé—´æˆ–é€‰æ‹©å…¶ä»–å­˜å‚¨ä½ç½®

### è°ƒè¯•æ¨¡å¼
åœ¨è„šæœ¬ä¸­æ·»åŠ è¯¦ç»†æ—¥å¿—:
```typescript
console.log('Debug:', { tableName, recordCount, error });
```

## ğŸ“ˆ æœ€ä½³å®è·µ

1. **å®šæœŸå¤‡ä»½**: å»ºç«‹è‡ªåŠ¨åŒ–å¤‡ä»½è®¡åˆ’
2. **ç‰ˆæœ¬æ§åˆ¶**: ä¿ç•™å¤šä¸ªç‰ˆæœ¬çš„å¤‡ä»½
3. **å¼‚åœ°å­˜å‚¨**: å°†å¤‡ä»½å¤åˆ¶åˆ°ä¸åŒä½ç½®
4. **æ¢å¤æµ‹è¯•**: å®šæœŸæµ‹è¯•æ¢å¤æµç¨‹
5. **æ–‡æ¡£æ›´æ–°**: ä¿æŒå¤‡ä»½æµç¨‹æ–‡æ¡£æœ€æ–°

## ğŸ”— ç›¸å…³æ–‡ä»¶

- `backup-supabase.ts` - å¤‡ä»½è„šæœ¬
- `restore-supabase.ts` - æ¢å¤è„šæœ¬  
- `backup-database.sh` - å¤‡ä»½ä¾¿æ·è„šæœ¬
- `restore-database.sh` - æ¢å¤ä¾¿æ·è„šæœ¬
- `DATABASE-BACKUP.md` - æœ¬æ–‡æ¡£

---

*æœ€åæ›´æ–°: 2025-09-09*
*é€‚ç”¨ç‰ˆæœ¬: AI Benchmark V2.5+*